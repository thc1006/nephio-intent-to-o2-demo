# üìä Services Deployment Record
**Date**: 2025-09-25
**Time**: 13:00 UTC

## üÜï Newly Deployed Services

### VM-1 (Orchestrator) - 172.16.0.78

#### 1. **Claude Intent Processor** ‚úÖ
- **File**: `/home/ubuntu/nephio-intent-to-o2-demo/services/claude_intent_processor.py`
- **Purpose**: Unified intent processing with VM-1 rules integration
- **Features**:
  - TMF921 schema validation
  - Deterministic parsing rules from VM-1
  - Claude CLI integration with `--dangerously-skip-permissions`
  - Fallback to rule-based processing
- **Status**: Tested and working

#### 2. **TMux WebSocket Bridge** ‚úÖ
- **File**: `/home/ubuntu/nephio-intent-to-o2-demo/services/tmux_websocket_bridge.py`
- **Port**: 8004
- **URL**: http://147.251.115.143:8004
- **Purpose**: Browser-based Claude CLI terminal
- **TMux Session**: `claude-intent`
- **Status**: Running

#### 3. **Web Frontend** ‚úÖ
- **File**: `/home/ubuntu/nephio-intent-to-o2-demo/web/index.html`
- **Port**: 8005
- **URL**: http://147.251.115.143:8005
- **Purpose**: Advanced UI with pipeline visualization
- **Status**: Running (Python HTTP server)

#### 4. **VictoriaMetrics** (Planned)
- **File**: `/home/ubuntu/nephio-intent-to-o2-demo/monitoring/vm1-observability-stack.yaml`
- **Port**: 8428 (planned: 30428)
- **Purpose**: Central TSDB for metrics from edge sites
- **Status**: Not yet deployed (no K8s on VM-1)

#### 5. **Grafana** (Planned)
- **File**: Included in `vm1-observability-stack.yaml`
- **Port**: 3000 (planned: 30300)
- **Purpose**: Central dashboard
- **Status**: Not yet deployed (no K8s on VM-1)

### VM-2 (Edge01) - 172.16.4.45

#### 1. **Config Sync RootSync** ‚úÖ
- **File**: `/home/ubuntu/configs-edge01-kpt/rootsync.yaml`
- **Generated by**: Claude CLI with CLAUDE.md E0
- **Git Repo**: http://172.16.0.78:8888/gitops/edge01-configs
- **Status**: Configuration generated

#### 2. **Prometheus + Thanos** (Planned)
- **File**: `/home/ubuntu/nephio-intent-to-o2-demo/edge-deployment/deploy-edge01.sh`
- **Port**: 30090
- **Remote Write**: To VM-1:8428
- **Status**: Script ready, not deployed

#### 3. **Flagger** (Planned)
- **File**: Included in `deploy-edge01.sh`
- **Purpose**: Canary deployments
- **Status**: Script ready, not deployed

### VM-4 (Edge02) - 172.16.4.176

#### 1. **Config Sync RootSync** ‚úÖ
- **File**: `/home/ubuntu/configs-edge02-kpt/rootsync.yaml`
- **Generated by**: Claude CLI with CLAUDE.md E0
- **Git Repo**: http://172.16.0.78:8888/gitops/edge02-configs
- **Status**: Configuration generated

#### 2. **Prometheus + Thanos** (Planned)
- **File**: `/home/ubuntu/nephio-intent-to-o2-demo/edge-deployment/deploy-edge02.sh`
- **Port**: 30090
- **Remote Write**: To VM-1:8428
- **Status**: Script ready, not deployed

#### 3. **Flagger** (Planned)
- **File**: Included in `deploy-edge02.sh`
- **Purpose**: Canary deployments
- **Status**: Script ready, not deployed

---

## üìã Service Status Summary

| Service | VM | Port | URL | Status |
|---------|-----|------|-----|--------|
| **Gitea** | VM-1 | 8888 | http://147.251.115.143:8888 | ‚úÖ Running |
| **Claude API** | VM-1 | 8002 | http://147.251.115.143:8002 | ‚úÖ Running |
| **Real-time Monitor** | VM-1 | 8001 | http://147.251.115.143:8001 | ‚úÖ Running |
| **TMux Bridge** | VM-1 | 8004 | http://147.251.115.143:8004 | ‚úÖ Running |
| **Web Frontend** | VM-1 | 8005 | http://147.251.115.143:8005 | ‚úÖ Running |
| **Claude Processor** | VM-1 | N/A | Internal | ‚úÖ Tested |
| **Config Sync** | VM-2 | N/A | N/A | ‚úÖ Config Ready |
| **Config Sync** | VM-4 | N/A | N/A | ‚úÖ Config Ready |
| **VictoriaMetrics** | VM-1 | 8428 | N/A | ‚è≥ Pending K8s |
| **Grafana** | VM-1 | 3000 | N/A | ‚è≥ Pending K8s |
| **Prometheus** | VM-2 | 30090 | N/A | ‚è≥ Pending Deploy |
| **Prometheus** | VM-4 | 30090 | N/A | ‚è≥ Pending Deploy |
| **Flagger** | VM-2 | N/A | N/A | ‚è≥ Pending Deploy |
| **Flagger** | VM-4 | N/A | N/A | ‚è≥ Pending Deploy |

---

## üîß Deployment Commands

### VM-1 Services (Already Running)
```bash
# TMux WebSocket Bridge
nohup python3 /home/ubuntu/nephio-intent-to-o2-demo/services/tmux_websocket_bridge.py &

# Web Frontend
cd /home/ubuntu/nephio-intent-to-o2-demo/web && python3 -m http.server 8005 &

# Claude Intent Processor (library mode)
python3 /home/ubuntu/nephio-intent-to-o2-demo/services/claude_intent_processor.py
```

### VM-2 Deployment
```bash
# Copy and run from VM-1
scp /home/ubuntu/nephio-intent-to-o2-demo/edge-deployment/deploy-edge01.sh ubuntu@172.16.4.45:~/
ssh ubuntu@172.16.4.45 'chmod +x ~/deploy-edge01.sh && ./deploy-edge01.sh'
```

### VM-4 Deployment
```bash
# Copy and run from VM-1
scp /home/ubuntu/nephio-intent-to-o2-demo/edge-deployment/deploy-edge02.sh ubuntu@172.16.4.176:~/
ssh ubuntu@172.16.4.176 'chmod +x ~/deploy-edge02.sh && ./deploy-edge02.sh'
```

---

## üß™ Testing Commands

### Test All VM-1 Services
```bash
# Run comprehensive test
/home/ubuntu/nephio-intent-to-o2-demo/scripts/test_all_services.sh
```

### Individual Service Tests
```bash
# Test Gitea
curl -I http://147.251.115.143:8888

# Test Claude API
curl -X POST http://147.251.115.143:8002/api/v1/intent \
  -H 'Content-Type: application/json' \
  -d '{"text": "Deploy eMBB on edge01"}'

# Test TMux Bridge
curl http://147.251.115.143:8004/health

# Test Web Frontend
curl -I http://147.251.115.143:8005

# Test Claude Processor
python3 -c "from services.claude_intent_processor import process_intent; print(process_intent('Deploy eMBB'))"
```

---

## üìù Notes

1. **K8s Requirement**: VM-1 needs Kubernetes for VictoriaMetrics and Grafana
2. **Edge Deployment**: VM-2 and VM-4 need Kubernetes for full stack
3. **Gitea Actions**: Not yet configured, needs act_runner setup
4. **Remote Write**: Requires VictoriaMetrics on VM-1 to receive edge metrics

---

## üöÄ Next Steps

1. Install K8s on VM-1 (k3s recommended for lightweight)
2. Deploy VictoriaMetrics and Grafana on VM-1
3. Verify K8s on VM-2 and VM-4
4. Deploy Prometheus and Flagger to edge sites
5. Configure Gitea Actions Runner
6. Set up webhooks for GitOps automation