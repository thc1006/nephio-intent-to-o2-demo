{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "apiVersion": {
      "type": "string",
      "enum": ["cn.nephio.org/v1alpha1"]
    },
    "kind": {
      "type": "string",
      "enum": ["CNBundle"]
    },
    "metadata": {
      "$ref": "#/definitions/metadata"
    },
    "spec": {
      "$ref": "#/definitions/cnBundleSpec"
    },
    "status": {
      "$ref": "#/definitions/cnBundleStatus"
    }
  },
  "required": ["apiVersion", "kind", "metadata", "spec"],
  "additionalProperties": false,
  "definitions": {
    "metadata": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[a-z0-9]([a-z0-9\\-]{0,61}[a-z0-9])?$"
        },
        "namespace": {
          "type": "string",
          "pattern": "^[a-z0-9]([a-z0-9\\-]{0,61}[a-z0-9])?$"
        },
        "labels": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        },
        "annotations": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      },
      "required": ["name"],
      "additionalProperties": true
    },
    "cnBundleSpec": {
      "type": "object",
      "properties": {
        "expectationId": {
          "type": "string",
          "description": "ID of the 3GPP TS 28.312 expectation this bundle implements"
        },
        "expectationType": {
          "type": "string",
          "enum": ["ServicePerformance", "ServiceCapacity", "ServiceCoverage"],
          "description": "Type of expectation from 3GPP TS 28.312"
        },
        "networkSlices": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^slice-[a-z0-9\\-]+$"
          },
          "description": "List of network slices this bundle applies to"
        },
        "capacity": {
          "$ref": "#/definitions/capacityRequirement"
        },
        "performance": {
          "$ref": "#/definitions/performanceRequirement"
        },
        "coverage": {
          "$ref": "#/definitions/coverageRequirement"
        },
        "objectInstance": {
          "type": "string",
          "description": "Instance identifier of the target core network object"
        }
      },
      "required": ["expectationId", "expectationType", "objectInstance"],
      "additionalProperties": false
    },
    "cnBundleStatus": {
      "type": "object",
      "properties": {
        "phase": {
          "type": "string",
          "enum": ["Pending", "Ready", "Failed"]
        },
        "conditions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/condition"
          }
        }
      },
      "additionalProperties": false
    },
    "capacityRequirement": {
      "type": "object",
      "properties": {
        "latency": {
          "$ref": "#/definitions/requirement"
        },
        "throughput": {
          "$ref": "#/definitions/requirement"
        },
        "connections": {
          "$ref": "#/definitions/requirement"
        }
      },
      "additionalProperties": false
    },
    "performanceRequirement": {
      "type": "object",
      "properties": {
        "throughput": {
          "$ref": "#/definitions/requirement"
        },
        "latency": {
          "$ref": "#/definitions/requirement"
        },
        "jitter": {
          "$ref": "#/definitions/requirement"
        }
      },
      "additionalProperties": false
    },
    "coverageRequirement": {
      "type": "object",
      "properties": {
        "availability": {
          "$ref": "#/definitions/requirement"
        },
        "reliability": {
          "$ref": "#/definitions/requirement"
        },
        "coverage": {
          "$ref": "#/definitions/requirement"
        }
      },
      "additionalProperties": false
    },
    "requirement": {
      "type": "object",
      "properties": {
        "condition": {
          "type": "string",
          "enum": [
            "EQUAL",
            "NOT_EQUAL",
            "GREATER_THAN",
            "GREATER_THAN_OR_EQUAL",
            "LESS_THAN",
            "LESS_THAN_OR_EQUAL",
            "CONTAINS",
            "NOT_CONTAINS"
          ]
        },
        "value": {
          "type": "string",
          "description": "Value with appropriate units (e.g., '100Mbps', '1ms', '99.9%')"
        }
      },
      "required": ["condition", "value"],
      "additionalProperties": false
    },
    "condition": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string"
        },
        "status": {
          "type": "string",
          "enum": ["True", "False", "Unknown"]
        },
        "reason": {
          "type": "string"
        },
        "message": {
          "type": "string"
        },
        "lastTransitionTime": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["type", "status"],
      "additionalProperties": false
    }
  }
}